import streamlit as st
from game_guide import GameGuide
from game_content import GAME_CONTENT
import time
from api_handler import APIHandler

class GameGuideWeb:
    def __init__(self):
        self.guide = GameGuide()
        self.api = APIHandler()
        
    def run(self):
        # ËÆæÁΩÆÈ°µÈù¢ÈÖçÁΩÆ
        st.set_page_config(
            page_title="Ê∏∏ÊàèÊåáÂçó",
            page_icon="üéÆ",
            layout="wide",
            initial_sidebar_state="expanded"
        )
        
        # Êõ¥Êñ∞CSSÊ†∑Âºè
        st.markdown("""
        <style>
        /* ÂÖ®Â±ÄÊ†∑Âºè */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        
        * {
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        /* Âä®ÊÄÅÊ∑±ËìùÊ∏êÂèòËÉåÊôØ */
        .stApp {
            background: 
                linear-gradient(45deg, 
                    rgba(15, 23, 42, 0.95),   /* Ê∑±ÈÇÉËìù */
                    rgba(23, 37, 84, 0.95),   /* ÈùõËìù */
                    rgba(30, 58, 138, 0.95)), /* ÁöáÂÆ∂Ëìù */
                linear-gradient(135deg,
                    rgba(17, 24, 39, 0.97),   /* ÊöóËìù */
                    rgba(29, 78, 216, 0.97));  /* ‰∫ÆËìù */
            background-size: 400% 400%, 300% 300%;
            animation: gradientBG 15s ease infinite;
        }
        
        @keyframes gradientBG {
            0% {
                background-position: 0% 50%, 100% 50%;
            }
            25% {
                background-position: 50% 100%, 50% 0%;
            }
            50% {
                background-position: 100% 50%, 0% 50%;
            }
            75% {
                background-position: 50% 0%, 50% 100%;
            }
            100% {
                background-position: 0% 50%, 100% 50%;
            }
        }
        
        /* Âä®ÊÄÅÂÖâÊïà */
        .stApp::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%,
                    rgba(59, 130, 246, 0.1) 0%,
                    transparent 50%),
                radial-gradient(circle at 80% 70%,
                    rgba(37, 99, 235, 0.1) 0%,
                    transparent 50%);
            animation: lightEffect 20s ease-in-out infinite alternate;
        }
        
        @keyframes lightEffect {
            0% {
                opacity: 0.5;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2);
            }
            100% {
                opacity: 0.5;
                transform: scale(1);
            }
        }
        
        /* Âä®ÊÄÅÁéªÁíÉÂç°Áâá */
        .glass-card {
            background: rgba(23, 37, 84, 0.4);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 24px;
            padding: 25px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }
        
        .glass-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(
                circle,
                rgba(59, 130, 246, 0.1) 0%,
                transparent 60%
            );
            animation: cardLight 8s ease-in-out infinite;
        }
        
        @keyframes cardLight {
            0% {
                transform: translate(-30%, -30%) rotate(0deg);
            }
            50% {
                transform: translate(30%, 30%) rotate(180deg);
            }
            100% {
                transform: translate(-30%, -30%) rotate(360deg);
            }
        }
        
        /* ÁÇ´ÂΩ©ÊñáÂ≠óÊïàÊûú */
        .rainbow-text {
            background: linear-gradient(
                to right,
                #3b82f6,  /* ‰∫ÆËìùËâ≤ */
                #60a5fa,  /* Â§©ËìùËâ≤ */
                #93c5fd,  /* ÊµÖËìùËâ≤ */
                #2563eb   /* Ê∑±ËìùËâ≤ */
            );
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: rainbow 8s linear infinite;
            background-size: 200% auto;
        }
        
        @keyframes rainbow {
            to {
                background-position: 200% center;
            }
        }
        
        /* ÊåâÈíÆÊ†∑Âºè */
        .stButton > button {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);  /* ËìùËâ≤Ê∏êÂèò */
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .stButton > button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                120deg,
                transparent,
                rgba(255,255,255,0.3),
                transparent
            );
            transition: 0.5s;
        }
        
        .stButton > button:hover::before {
            left: 100%;
        }
        
        .stButton > button:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #3b82f6 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        /* 3DÂç°ÁâáÊïàÊûú */
        .card-3d {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .card-3d:hover {
            transform: rotateX(5deg) rotateY(5deg);
        }
        
        /* Âä®ÊÄÅËæπÊ°Ü */
        .animated-border {
            position: relative;
        }
        
        .animated-border::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 24px;
            padding: 2px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #a777e3);
            -webkit-mask: 
                linear-gradient(#fff 0 0) content-box, 
                linear-gradient(#fff 0 0);
            mask: 
                linear-gradient(#fff 0 0) content-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: borderRotate 4s linear infinite;
        }
        
        @keyframes borderRotate {
            to {
                transform: rotate(360deg);
            }
        }
        
        /* ÊªöÂä®Êù°Ê†∑Âºè */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(23, 37, 84, 0.3);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #a777e3, #6e8efb);
        }
        
        /* ËæìÂÖ•Ê°ÜÊ†∑Âºè */
        .stTextInput>div>div>input,
        .stTextArea>div>div>textarea {
            background: rgba(23, 37, 84, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            color: white;
            padding: 12px 20px;
            transition: all 0.3s ease;
        }
        
        .stTextInput>div>div>input:focus,
        .stTextArea>div>div>textarea:focus {
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.1);
        }
        
        /* Ê†áÁ≠æÈ°µÊ†∑Âºè */
        .stTabs [data-baseweb="tab-list"] {
            gap: 10px;
            background: rgba(23, 37, 84, 0.3);
            padding: 10px;
            border-radius: 50px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .stTabs [data-baseweb="tab"] {
            background: transparent;
            border-radius: 50px;
            color: rgba(255, 255, 255, 0.7);
            padding: 10px 20px;
            transition: all 0.3s ease;
        }
        
        .stTabs [data-baseweb="tab"][aria-selected="true"] {
            background: rgba(59, 130, 246, 0.3);
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Ê¨¢ËøéÈ°µÈù¢Ê†∑Âºè */
        .welcome-container {
            width: 80%;
            max-width: 1200px;
            margin: 15vh auto;
            text-align: center;
            padding: 4rem;
            background: linear-gradient(135deg, 
                rgba(88, 216, 232, 0.8),
                rgba(187, 137, 255, 0.8));
            border-radius: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .welcome-title {
            font-size: 4vw;
            color: white;
            text-shadow: 0 0 10px rgba(0,0,0,0.3);
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(30px);
            animation: slideUp 0.8s ease 0.5s forwards;
        }
        
        .welcome-subtitle {
            font-size: 2vw;
            color: rgba(255,255,255,0.9);
            margin-bottom: 3rem;
            opacity: 0;
            transform: translateY(20px);
            animation: slideUp 0.8s ease 1s forwards;
        }
        
        /* ÂìçÂ∫îÂºèË∞ÉÊï¥ */
        @media (min-width: 1400px) {
            .welcome-title {
                font-size: 56px;
            }
            .welcome-subtitle {
                font-size: 28px;
            }
        }
        
        @media (max-width: 768px) {
            .welcome-container {
                width: 90%;
                padding: 2rem;
                margin: 10vh auto;
            }
            .welcome-title {
                font-size: 32px;
            }
            .welcome-subtitle {
                font-size: 18px;
            }
        }
        
        /* ËøõÂÖ•ÊåâÈíÆÊ†∑Âºè */
        .stButton > button {
            margin-top: 2rem;
            padding: 0.8rem 3rem;
            font-size: 1.2rem;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        
        .stButton > button:hover {
            background: linear-gradient(135deg, #00f2fe 0%, #4facfe 100%);
        }
        
        @keyframes slideUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Ë∞ÉÊï¥Êï¥‰ΩìÂ∏ÉÂ±Ä */
        .main {
            padding: 0 !important;
            margin: 0 !important;
        }
        
        .block-container {
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            margin: 0 !important;
        }
        
        /* ‰∏ªÊ†áÈ¢òÊ†∑Âºè */
        .main-title {
            font-size: 2.5vw;
            text-align: center;
            margin-top: 3rem;
            padding: 2rem;
            background: linear-gradient(120deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
            position: relative;
            z-index: 100;
        }
        
        .content-container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Ê†áÁ≠æÈ°µÊ†∑Âºè‰ºòÂåñ */
        .stTabs {
            background: rgba(30, 41, 59, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-top: 2rem;
        }
        
        .glass-card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin: 1rem 0;
            border: 1px solid rgba(78, 91, 112, 0.2);
        }
        
        /* ÂÜÖÂÆπÂå∫ÂüüÊ†∑Âºè */
        .content-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        
        @media (min-width: 1400px) {
            .main-title {
                font-size: 36px;
            }
        }
        
        @media (max-width: 768px) {
            .main-title {
                font-size: 24px;
            }
            .content-container {
                width: 95%;
                padding: 1rem;
            }
        }
        
        /* Ê¢¶ÂπªÊ≥°Ê≥°ÊïàÊûú */
        .bubble {
            position: fixed;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float-bubble 8s infinite ease-in-out;
            pointer-events: none;
        }
        
        @keyframes float-bubble {
            0%, 100% {
                transform: translateY(0) translateX(0);
            }
            50% {
                transform: translateY(-100px) translateX(20px);
            }
        }
        
        /* ÊµÅÊòüÊïàÊûú */
        .shooting-stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .shooting-star {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(59, 130, 246, 0.8), 
                rgba(37, 99, 235, 0.4), 
                transparent);
            animation: shootingStars 3s linear infinite;
        }
        
        @keyframes shootingStars {
            0% {
                transform: translateX(-100%) translateY(0) rotate(-45deg);
                opacity: 1;
            }
            100% {
                transform: translateX(200%) translateY(300%) rotate(-45deg);
                opacity: 0;
            }
        }
        
        /* Ê∞îÊ≥°ÊïàÊûú */
        .bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .bubble {
            position: absolute;
            background: radial-gradient(
                circle at 50% 50%,
                rgba(59, 130, 246, 0.2),
                rgba(37, 99, 235, 0.1)
            );
            border-radius: 50%;
            animation: floatBubble linear infinite;
        }
        
        @keyframes floatBubble {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }
        
        /* ÂÖâÊôïÊïàÊûú */
        .glow {
            position: fixed;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: glow-pulse 4s infinite ease-in-out;
            pointer-events: none;
        }
        
        @keyframes glow-pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }
        
        /* ‰æßËæπÊ†èÊ†∑Âºè */
        .sidebar .sidebar-content {
            background: linear-gradient(
                180deg,
                rgba(15, 23, 42, 0.95),
                rgba(23, 37, 84, 0.95)
            );
            border-right: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .sidebar .sidebar-content > div {
            background: transparent !important;
        }
        
        /* ÊñáÂ≠óÈ¢úËâ≤ */
        p, li {
            color: rgba(226, 232, 240, 0.85);  /* ÊµÖÁÅ∞ËìùËâ≤ÊñáÂ≠ó */
        }
        
        h1, h2, h3, h4 {
            color: rgba(241, 245, 249, 0.95);  /* ËøëÁôΩËâ≤Ê†áÈ¢ò */
        }
        
        /* ÂØºËà™ËèúÂçïÈ°πÊ†∑Âºè */
        .stRadio > label {
            background: rgba(30, 58, 138, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            padding: 10px 15px;
            margin: 5px 0;
            transition: all 0.3s ease;
        }
        
        .stRadio > label:hover {
            background: rgba(30, 58, 138, 0.5);
            transform: translateX(5px);
        }
        
        /* Áä∂ÊÄÅÂç°ÁâáÊ†∑Âºè */
        .status-card {
            transition: all 0.3s ease;
            margin: 10px 0;
        }
        
        .status-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .status-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .status-icon {
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 50%;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .status-desc {
            color: rgba(255, 255, 255, 0.8);
            margin: 0;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .attribute-card {
            background: rgba(30, 58, 138, 0.4);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        
        /* ÂØºËà™ËèúÂçïÂõæÊ†áÂä®Áîª */
        .sidebar .sidebar-content img,
        .sidebar .sidebar-content svg {
            transition: transform 0.3s ease;
        }
        
        .sidebar .sidebar-content img:hover,
        .sidebar .sidebar-content svg:hover {
            transform: scale(1.1);
        }
        
        /* ÈÄâ‰∏≠Áä∂ÊÄÅÊ†∑Âºè */
        .stRadio > div[role="radiogroup"] > label[data-baseweb="radio"] > div:first-child {
            background-color: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .stRadio > div[role="radiogroup"] > label[data-baseweb="radio"][aria-checked="true"] {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateX(10px);
        }
        
        /* ‰æßËæπÊ†èÂ§¥ÈÉ®Ê†∑Âºè */
        .sidebar-header {
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            background: rgba(30, 58, 138, 0.3);
        }
        
        .sidebar-header h2 {
            color: white;
            margin-top: 1rem;
            font-size: 1.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* ËÑâÂÜ≤logoÂä®Áîª */
        .logo-pulse {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            border-radius: 50%;
            position: relative;
            animation: pulse 2s infinite;
        }
        
        .logo-pulse::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: inherit;
            border-radius: inherit;
            animation: pulse-ring 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(0.95);
            }
            50% {
                transform: scale(1);
            }
            100% {
                transform: scale(0.95);
            }
        }
        
        @keyframes pulse-ring {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }
        
        /* ÂØºËà™ËèúÂçïÈ°πÊ†∑Âºè */
        .sidebar .sidebar-content [data-testid="stRadio"] > div {
            padding: 0.5rem;
        }
        
        .sidebar .sidebar-content [data-testid="stRadio"] label {
            background: rgba(30, 58, 138, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin: 0.5rem 0;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .sidebar .sidebar-content [data-testid="stRadio"] label:hover {
            background: rgba(30, 58, 138, 0.4);
            transform: translateX(5px);
            border-color: rgba(59, 130, 246, 0.4);
        }
        
        /* ÈÄâ‰∏≠Áä∂ÊÄÅÊ†∑Âºè */
        .sidebar .sidebar-content [data-testid="stRadio"] label[data-checked="true"] {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.2);
        }
        
        /* ËèúÂçïÂõæÊ†áÊ†∑Âºè */
        .sidebar .sidebar-content [data-testid="stRadio"] label span {
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* ÂàÜÂâ≤Á∫øÊ†∑Âºè */
        .sidebar .sidebar-content hr {
            border-color: rgba(59, 130, 246, 0.2);
            margin: 2rem 0;
        }
        
        /* ÊªöÂä®Êù°Ê†∑Âºè */
        .sidebar .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-track {
            background: rgba(30, 58, 138, 0.1);
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.3);
            border-radius: 3px;
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.5);
        }
        
        /* ÂØºËà™ËèúÂçïÂÆπÂô® */
        .nav-menu {
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .nav-menu-items {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        /* ÂØºËà™ËèúÂçïÈ°π */
        .nav-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.2rem;
            background: rgba(30, 58, 138, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .nav-item:hover {
            background: rgba(30, 58, 138, 0.4);
            transform: translateX(5px);
            border-color: rgba(59, 130, 246, 0.4);
            color: white;
        }
        
        .nav-item.active {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.2);
            color: white;
        }
        
        /* ÂØºËà™ÂõæÊ†á */
        .nav-icon {
            font-size: 1.2rem;
            margin-right: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover .nav-icon {
            background: rgba(59, 130, 246, 0.2);
            transform: scale(1.1);
        }
        
        /* ÂØºËà™ÊñáÂ≠ó */
        .nav-text {
            font-size: 1rem;
            font-weight: 500;
        }
        
        /* ÁßªÈô§ÂéüÊúâÁöÑÊ†áÈ¢òÊ†∑Âºè */
        .sidebar .sidebar-content [data-testid="stMarkdown"] h3 {
            display: none;
        }
        
        /* ‰ºòÂåñ‰æßËæπÊ†èÊï¥‰ΩìÊ†∑Âºè */
        .sidebar .sidebar-content {
            background: linear-gradient(
                180deg,
                rgba(15, 23, 42, 0.95),
                rgba(23, 37, 84, 0.95)
            );
            border-right: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        /* ‰ºòÂåñÊªöÂä®Êù° */
        .sidebar .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-track {
            background: rgba(30, 58, 138, 0.1);
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.3);
            border-radius: 3px;
        }
        
        .sidebar .sidebar-content::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.5);
        }
        
        /* È°µÈù¢Ê†áÈ¢òÊ†∑Âºè */
        .page-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: rgba(30, 58, 138, 0.2);
            border-radius: 16px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .page-header h2 {
            color: white;
            margin-bottom: 0.5rem;
        }
        
        .page-header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }
        
        /* Ë°®ÂçïÊ†∑Âºè */
        [data-testid="stForm"] {
            background: rgba(30, 58, 138, 0.2);
            padding: 2rem;
            border-radius: 16px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .stTextInput input, .stTextArea textarea {
            background: rgba(23, 37, 84, 0.3) !important;
            border: 1px solid rgba(59, 130, 246, 0.2) !important;
            color: white !important;
        }
        
        .stSelectbox [data-baseweb="select"] {
            background: rgba(23, 37, 84, 0.3) !important;
            border: 1px solid rgba(59, 130, 246, 0.2) !important;
        }
        
        /* ÊåáÂçóÂç°ÁâáÊ†∑Âºè */
        .guide-card {
            height: 100%;
            padding: 1.5rem;
        }
        
        .guide-card h4 {
            color: white;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            padding-bottom: 0.5rem;
        }
        
        .guide-card ul {
            list-style: none;
            padding: 0;
            margin: 0 0 1.5rem 0;
        }
        
        .guide-card li {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .guide-card li:before {
            content: '‚Ä¢';
            color: #3b82f6;
            position: absolute;
            left: 0;
        }
        
        /* Êèê‰∫§ÊåâÈíÆÊ†∑Âºè */
        .stButton button {
            width: 100%;
            padding: 0.8rem !important;
            font-size: 1.1rem !important;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%) !important;
            transition: all 0.3s ease !important;
        }
        
        .stButton button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        </style>
        
        <script>
        // ÂàõÂª∫ÊµÅÊòü
        function createShootingStars() {
            const container = document.createElement('div');
            container.className = 'shooting-stars';
            document.body.appendChild(container);
            
            setInterval(() => {
                const star = document.createElement('div');
                star.className = 'shooting-star';
                star.style.top = Math.random() * 50 + 'vh';
                star.style.left = Math.random() * 100 + 'vw';
                container.appendChild(star);
                
                setTimeout(() => star.remove(), 3000);
            }, 2000);
        }
        
        // ÂàõÂª∫Ê∞îÊ≥°
        function createBubbles() {
            const container = document.createElement('div');
            container.className = 'bubbles';
            document.body.appendChild(container);
            
            setInterval(() => {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                
                // ÈöèÊú∫Â§ßÂ∞è
                const size = Math.random() * 30 + 10;
                bubble.style.width = size + 'px';
                bubble.style.height = size + 'px';
                
                // ÈöèÊú∫‰ΩçÁΩÆ
                bubble.style.left = Math.random() * 100 + 'vw';
                
                // ÈöèÊú∫Âä®ÁîªÊó∂Èó¥
                const duration = Math.random() * 10 + 5;
                bubble.style.animation = `floatBubble ${duration}s linear infinite`;
                
                container.appendChild(bubble);
                setTimeout(() => bubble.remove(), duration * 1000);
            }, 500);
        }
        
        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñÊïàÊûú
        document.addEventListener('DOMContentLoaded', () => {
            createShootingStars();
            createBubbles();
        });
        
        // Ê∑ªÂä†ÂØºËà™ËèúÂçï‰∫§‰∫í
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    navItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });
        </script>
        """, unsafe_allow_html=True)
        
        # ‰ΩøÁî® session_state ÊéßÂà∂Ê¨¢ËøéÈ°µÈù¢ÁöÑÊòæÁ§∫
        if 'show_welcome' not in st.session_state:
            st.session_state.show_welcome = True
        
        # Â¶ÇÊûú‰∏çÊòØÊ¨¢ËøéÈ°µÈù¢ÔºåÊòæÁ§∫Âõ∫ÂÆöÊ†áÈ¢ò
        if not st.session_state.get('show_welcome', True):
            # Ê∑ªÂä†‰∏Ä‰∫õÁ©∫Ë°åÊù•Ë∞ÉÊï¥Ê†áÈ¢ò‰ΩçÁΩÆ
            st.markdown("<br>" * 2, unsafe_allow_html=True)
            st.markdown('<h1 class="main-title">‚ú® Ê∏∏ÊàèÊåáÂçó ‚ú®</h1>', unsafe_allow_html=True)
        
        # ÊòæÁ§∫Ê¨¢ËøéÈ°µÈù¢Êàñ‰∏ªÂÜÖÂÆπ
        if st.session_state.show_welcome:
            # ÁßªÈô§ÈªòËÆ§ÁöÑÈ°µÈù¢ËæπË∑ù
            st.markdown("""
                <style>
                    .block-container {
                        padding: 0;
                    }
                </style>
            """, unsafe_allow_html=True)
            
            # ÂàõÂª∫‰∏Ä‰∏™Â±Ö‰∏≠ÁöÑÊ¨¢ËøéÂÜÖÂÆπ
            st.markdown("""
                <div class="welcome-container">
                    <h1 class="welcome-title">‚ú® Ê¨¢ËøéÊù•Âà∞Ê¢¶Âπª‰∏ñÁïå ‚ú®</h1>
                    <p class="welcome-subtitle">ÂºÄÂêØ‰Ω†ÁöÑÂ•áÂπª‰πãÊóÖ</p>
                </div>
            """, unsafe_allow_html=True)
            
            # Ê∑ªÂä†‰∏Ä‰∏™Â±Ö‰∏≠ÁöÑÊåâÈíÆ
            col1, col2, col3 = st.columns([2, 1, 2])
            with col2:
                if st.button("ÁÇπÂáªËøõÂÖ•", use_container_width=True):
                    st.session_state.show_welcome = False
                    st.rerun()
        else:
            # ÊòæÁ§∫‰∏ªÈ°µÈù¢ÂÜÖÂÆπ
            with st.spinner('Ê≠£Âú®Âä†ËΩΩÁ≤æÂΩ©ÂÜÖÂÆπ...'):
                time.sleep(0.5)
            
            # ‰æßËæπÊ†è
            with st.sidebar:
                st.markdown("""
                <div class="sidebar-header">
                    <div class="logo-pulse"></div>
                    <h2>‚ú® Ê¢¶ÂπªÊåáÂçó</h2>
                </div>
                """, unsafe_allow_html=True)
                
                # ÁÆÄÂçïÁõ¥Êé•Âú∞‰ΩøÁî® radio ÊåâÈíÆ
                selection = st.radio(
                    "ÂØºËà™ËèúÂçï",  # Ê∑ªÂä†Ê†áÈ¢ò
                    list(self.guide.main_menu.values()),
                    format_func=lambda x: {
                        "Ê∏∏ÊàèÊîªÁï•": "üéØ Ê∏∏ÊàèÊîªÁï•",
                        "ÊÑèËßÅÂæÅÈõÜ": "üí° ÊÑèËßÅÂæÅÈõÜ",
                        "Â∑•‰ΩúÂÆ§ÊãõÂãü(ÊöÇÊó∂ÂÖ≥Èó≠)": "üè¢ Â∑•‰ΩúÂÆ§ÊãõÂãü"
                    }.get(x, x)
                )
                
                # Ê∑ªÂä†ÁÆÄÂçïÁöÑÊ†∑Âºè
                st.markdown("""
                <style>
                .sidebar .sidebar-content {
                    background: linear-gradient(
                        180deg,
                        rgba(15, 23, 42, 0.95),
                        rgba(23, 37, 84, 0.95)
                    );
                }
                
                /* RadioÊåâÈíÆÊ†∑Âºè */
                .stRadio > div {
                    background: rgba(30, 58, 138, 0.2);
                    padding: 1rem;
                    border-radius: 10px;
                }
                
                .stRadio > div > label {
                    background: rgba(30, 58, 138, 0.3);
                    border: 1px solid rgba(59, 130, 246, 0.2);
                    border-radius: 8px;
                    padding: 10px 15px;
                    margin: 5px 0;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                
                .stRadio > div > label:hover {
                    background: rgba(59, 130, 246, 0.2);
                    transform: translateX(5px);
                }
                
                /* ÈÄâ‰∏≠Áä∂ÊÄÅ */
                .stRadio > div > label[data-checked="true"] {
                    background: rgba(59, 130, 246, 0.3);
                    border-color: rgba(59, 130, 246, 0.6);
                    box-shadow: 0 0 15px rgba(59, 130, 246, 0.2);
                }
                </style>
                """, unsafe_allow_html=True)
            
            # ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü
            if selection == "Ê∏∏ÊàèÊîªÁï•":
                self.show_game_guide()
            elif selection == "ÊÑèËßÅÂæÅÈõÜ":
                self.show_feedback()
            else:
                self.show_recruitment()
            
    def show_game_guide(self):
        # ‰ΩøÁî®tabsÊù•ÁªÑÁªáÂÜÖÂÆπ
        tabs = st.tabs([
            "üéÆ Âü∫Á°ÄÊåáÂçó", "‚öîÔ∏è ËÅå‰∏öÁ≥ªÁªü", "üí™ Áä∂ÊÄÅÂ±ûÊÄß", "‚ú® ÁâπËâ≤Áé©Ê≥ï", "üìù Êõ¥Êñ∞Êó•Âøó"
        ])
        
        with tabs[0]:
            col1, col2 = st.columns([3, 1])
            with col1:
                guide_selection = st.selectbox(
                    "ÈÄâÊã©ÊåáÂçóÂÜÖÂÆπ",
                    list(self.guide.game_guide_submenu.values())
                )
        
        with st.spinner('Âä†ËΩΩ‰∏≠...'):
            time.sleep(0.3)
            self.show_guide_content(guide_selection)
        
        with tabs[1]:
            self.show_profession_content()
        
        with tabs[2]:
            self.show_status_content()

    def show_guide_content(self, selection):
        content = self.api.get_game_content(selection)
        st.markdown(f"""
        <div class="glass-card">
            <h3 style="color: white; margin-bottom: 1.5rem;">{selection}</h3>
            <div style="color: rgba(255,255,255,0.9);">
                {content.get('content', 'ÂÜÖÂÆπÊ≠£Âú®Êõ¥Êñ∞‰∏≠...')}
            </div>
        </div>
        """, unsafe_allow_html=True)

    def show_feedback(self):
        """ÊòæÁ§∫ÊÑèËßÅÂæÅÈõÜÈ°µÈù¢"""
        st.markdown("""
        <div class="page-header">
            <h2>üí° ÊÑèËßÅÂæÅÈõÜ</h2>
            <p>ÊÇ®ÁöÑÂèçÈ¶àÂØπÊàë‰ª¨ÂæàÈáçË¶ÅÔºåÂ∏ÆÂä©Êàë‰ª¨ÊâìÈÄ†Êõ¥Â•ΩÁöÑÊ∏∏Êàè‰ΩìÈ™åÔºÅ</p>
        </div>
        """, unsafe_allow_html=True)
        
        # ÂàõÂª∫‰∏§ÂàóÂ∏ÉÂ±Ä
        col1, col2 = st.columns([2, 1])
        
        with col1:
            with st.form("feedback_form"):
                # ÂèçÈ¶àÁ±ªÂûãÈÄâÊã©
                feedback_type = st.selectbox(
                    "ÈÄâÊã©ÂèçÈ¶àÁ±ªÂûã",
                    list(self.guide.feedback_submenu.values()),
                    format_func=lambda x: {
                        "ËÅå‰∏öÊÑèËßÅ": "‚öîÔ∏è ËÅå‰∏öÂπ≥Ë°°",
                        "Ë£ÖÂ§áÊÑèËßÅ": "üõ°Ô∏è Ë£ÖÂ§áÁ≥ªÁªü",
                        "ÊÄ™Áâ©ÊÑèËßÅ": "üëæ ÊÄ™Áâ©ËÆæËÆ°",
                        "BOSSÊÑèËßÅ": "üëë BOSSÊú∫Âà∂",
                        "Ê¢¶ÁÅµÊÑèËßÅ": "‚ú® Ê¢¶ÁÅµÁ≥ªÁªü",
                        "È•∞ÂìÅÊÑèËßÅ": "üíé È•∞ÂìÅÁ≥ªÁªü"
                    }.get(x, x)
                )
                
                # ÂèçÈ¶àÂÜÖÂÆπ
                feedback_text = st.text_area(
                    "ËØ¶ÁªÜÊèèËø∞",
                    height=200,
                    placeholder="ËØ∑ËØ¶ÁªÜÊèèËø∞ÊÇ®ÁöÑÊÉ≥Ê≥ï„ÄÅÂª∫ËÆÆÊàñÈÅáÂà∞ÁöÑÈóÆÈ¢ò..."
                )
                
                # ËÅîÁ≥ªÊñπÂºèÔºàÂèØÈÄâÔºâ
                contact = st.text_input(
                    "ËÅîÁ≥ªÊñπÂºèÔºàÈÄâÂ°´Ôºâ",
                    placeholder="QQ/ÂæÆ‰ø°/ÈÇÆÁÆ±ÔºåÊñπ‰æøÊàë‰ª¨‰∏éÊÇ®Ëøõ‰∏ÄÊ≠•‰∫§ÊµÅ"
                )
                
                # ÂõæÁâá‰∏ä‰º†ÔºàÂèØÈÄâÔºâ
                uploaded_file = st.file_uploader(
                    "‰∏ä‰º†Êà™ÂõæÔºàÂèØÈÄâÔºâ",
                    type=['png', 'jpg', 'jpeg'],
                    help="ÊîØÊåÅPNG/JPGÊ†ºÂºèÔºåÂ§ßÂ∞è‰∏çË∂ÖËøá2MB"
                )
                
                # Êèê‰∫§ÊåâÈíÆ
                submit = st.form_submit_button("üìÆ Êèê‰∫§ÂèçÈ¶à")
                
                if submit:
                    if feedback_text:
                        with st.spinner('Ê≠£Âú®Êèê‰∫§...'):
                            feedback_data = {
                                'type': feedback_type,
                                'content': feedback_text,
                                'contact': contact,
                                'has_image': bool(uploaded_file)
                            }
                            if self.api.save_feedback(feedback_data):
                                st.success("üéâ ÊÑüË∞¢ÊÇ®ÁöÑÂèçÈ¶àÔºÅÊàë‰ª¨‰ºöËÆ§ÁúüËÄÉËôëÊÇ®ÁöÑÂª∫ËÆÆ„ÄÇ")
                                st.balloons()
                    else:
                        st.error("ËØ∑Â°´ÂÜôÂèçÈ¶àÂÜÖÂÆπ")
        
        with col2:
            # ÂèçÈ¶àÊåáÂçó
            st.markdown("### üìù ÂèçÈ¶àÊåáÂçó")
            st.markdown("""
            ‚Ä¢ ËØ∑ÈÄâÊã©ÂêàÈÄÇÁöÑÂèçÈ¶àÁ±ªÂûã
            ‚Ä¢ ËØ¶ÁªÜÊèèËø∞ÊÇ®ÁöÑÊÉ≥Ê≥ïÂíåÂª∫ËÆÆ
            ‚Ä¢ ÂèØ‰ª•ÈôÑ‰∏äÊà™Âõæ‰ª•Êõ¥Â•ΩÂú∞ËØ¥ÊòéÈóÆÈ¢ò
            ‚Ä¢ Áïô‰∏ãËÅîÁ≥ªÊñπÂºè‰ª•‰æøÊàë‰ª¨Ëøõ‰∏ÄÊ≠•‰∫§ÊµÅ
            """)

    def show_recruitment(self):
        st.markdown('<div class="fade-in">', unsafe_allow_html=True)
        st.markdown("## üè¢ Â∑•‰ΩúÂÆ§ÊãõÂãü")
        
        st.warning("‚ö†Ô∏è ÊãõÂãüÈÄöÈÅìÊöÇÊó∂ÂÖ≥Èó≠")
        
        st.markdown("""
        <div class="glass-card">
            <h4>‚úâÔ∏è ËÆ¢ÈòÖÊãõÂãüÈÄöÁü•</h4>
            <p>ÂΩìÊúâÊñ∞ÁöÑÊãõÂãü‰ø°ÊÅØÊó∂ÔºåÊàë‰ª¨‰ºöÁ¨¨‰∏ÄÊó∂Èó¥ÈÄöÁü•ÊÇ®ÔºÅ</p>
        </div>
        """, unsafe_allow_html=True)
        
        email = st.text_input("ÈÇÆÁÆ±Âú∞ÂùÄ")
        if st.button("üîî ËÆ¢ÈòÖÈÄöÁü•"):
            if email and '@' in email:
                with st.spinner('Â§ÑÁêÜ‰∏≠...'):
                    if self.api.add_subscriber(email):
                        st.success("üéâ ËÆ¢ÈòÖÊàêÂäüÔºÅ")
                    else:
                        st.info("ÊÇ®Â∑≤ÁªèËÆ¢ÈòÖËøá‰∫Ü")
            else:
                st.error("ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈÇÆÁÆ±Âú∞ÂùÄ")

    def show_profession_content(self):
        """ÊòæÁ§∫ËÅå‰∏öÁ≥ªÁªüÂÜÖÂÆπ"""
        content = self.api.get_game_content("ËÅå‰∏öÁ≥ªÁªü")
        
        for profession, details in content.items():
            with st.expander(f"üéØ {profession}"):
                st.markdown(f"""
                <div class="glass-card">
                    <h4 style="color: white;">ÁâπÁÇπ</h4>
                    <p>{details['ÁâπÁÇπ']}</p>
                    
                    <h4 style="color: white;">ÊäÄËÉΩ</h4>
                    <ul>
                        {''.join(f'<li>{skill}</li>' for skill in details['ÊäÄËÉΩ'])}
                    </ul>
                    
                    <h4 style="color: white;">Êé®ËçêË£ÖÂ§á</h4>
                    <ul>
                        {''.join(f'<li>{equip}</li>' for equip in details['Ë£ÖÂ§áÊé®Ëçê'])}
                    </ul>
                </div>
                """, unsafe_allow_html=True)

    def show_status_content(self):
        """ÊòæÁ§∫Áä∂ÊÄÅÂ±ûÊÄßÂÜÖÂÆπ"""
        content = self.api.get_game_content("Áä∂ÊÄÅÂ±ûÊÄß")
        
        # ÂÆö‰πâÁä∂ÊÄÅÂõæÊ†áÊò†Â∞Ñ
        status_icons = {
            "ÁîüÂëΩÂÄº": "‚ù§Ô∏è",
            "È≠îÊ≥ïÂÄº": "üîÆ",
            "ÊîªÂáªÂäõ": "‚öîÔ∏è",
            "Èò≤Âæ°Âäõ": "üõ°Ô∏è",
            "Áú©Êôï": "üí´",
            "‰∏≠ÊØí": "‚ò†Ô∏è",
            "ËôöÂº±": "üò´",
            "Âä†ÈÄü": "‚ö°",
            "Áâ©ÁêÜÊäóÊÄß": "üè∞",
            "È≠îÊ≥ïÊäóÊÄß": "‚ú®",
            "ÊéßÂà∂ÊäóÊÄß": "üõë"
        }
        
        col1, col2, col3 = st.columns([1, 1, 1])
        
        with col1:
            st.markdown("""
            <div class="attribute-card">
                <h3 style="color: white;">Âü∫Á°ÄÂ±ûÊÄß</h3>
            </div>
            """, unsafe_allow_html=True)
            
            for attr, desc in content['Âü∫Á°ÄÂ±ûÊÄß'].items():
                st.markdown(f"""
                <div class="glass-card status-card">
                    <div class="status-header">
                        <span class="status-icon">{status_icons.get(attr, 'üîπ')}</span>
                        <h4 style="color: white; margin: 0;">{attr}</h4>
                    </div>
                    <p class="status-desc">{desc}</p>
                </div>
                """, unsafe_allow_html=True)
        
        with col2:
            st.markdown("""
            <div class="attribute-card">
                <h3 style="color: white;">ÁâπÊÆäÁä∂ÊÄÅ</h3>
            </div>
            """, unsafe_allow_html=True)
            
            for status, effect in content['ÁâπÊÆäÁä∂ÊÄÅ'].items():
                st.markdown(f"""
                <div class="glass-card status-card">
                    <div class="status-header">
                        <span class="status-icon">{status_icons.get(status, 'üî∏')}</span>
                        <h4 style="color: white; margin: 0;">{status}</h4>
                    </div>
                    <p class="status-desc">{effect}</p>
                </div>
                """, unsafe_allow_html=True)
            
        with col3:
            st.markdown("""
            <div class="attribute-card">
                <h3 style="color: white;">ÊäóÊÄßÁ≥ªÁªü</h3>
            </div>
            """, unsafe_allow_html=True)
            
            for resistance, desc in content['ÊäóÊÄßÁ≥ªÁªü'].items():
                st.markdown(f"""
                <div class="glass-card status-card">
                    <div class="status-header">
                        <span class="status-icon">{status_icons.get(resistance, 'üî∞')}</span>
                        <h4 style="color: white; margin: 0;">{resistance}</h4>
                    </div>
                    <p class="status-desc">{desc}</p>
                </div>
                """, unsafe_allow_html=True)

if __name__ == "__main__":
    web_guide = GameGuideWeb()
    web_guide.run()